SELECT ARRAY_TO_STRING(ARRAY_AGG("SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `"||catalog_name||"."||schema_name||".__TABLES__` where type=1")," UNION ALL ") AS final_query FROM `alert-impulse-704`.INFORMATION_SCHEMA.SCHEMATA
insert into gpcadmin.MetadataStore.all_projects_bq_tables_info SELECT project_id, dataset_id,table_id,creation_time,last_modified_time,CASE WHEN objtype = 1 THEN 'table' WHEN objtype = 2 THEN 'view' ELSE 'others' END AS obj_type, COUNT(*) AS tables, SUM(row_count) AS total_rows, SUM(size_bytes)/1e+6 AS size_mb, SUM(size_bytes)/1e+9 AS size_gb, SUM(size_bytes)/1e+12 AS size_tb,current_date() load_date FROM ( SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.TempWork.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.BobV_Fusion.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.DIServices_Dev.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Leanplum.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.DFPTemp.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Test_CCO_Events731.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.OrderItems.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PATRICK.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Adhoc.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Test_MissingGmt.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PrizeEngineTokenTransaction.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Talend_Test.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_OCM_Variables.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Looker_Scratch.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PartnerOfferConversion.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Playbuzz.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Experian.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Topix.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.refernece.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.adaggregate.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Temp_CCO.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.paws_test.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PCHSessionMetadata.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.TE_Entries.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_Temp.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.vip_compare.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.TempSN.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.DFP.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SpectrumPathVisitDetails.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Segments.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.cco_test.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.poc_appnexuslogs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.mixpanel_dev.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.d0239a79fd694f0d89ee9e2ff51c289d435c5fc5347a93.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Vip_compare.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AdSuperUser.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.bid_landscape_logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_SEG_Variables.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.CoBrand_Offer_work.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Acq_Spend.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.UserAgents.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PCHGames.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Stg_Topix.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Acquire_App.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.my_new_dataset.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AppNexus_Dev.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Line_Item.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.EcommerceActivity.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.APN_LineItem.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Dimensions.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SubscriberAddresses.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.poc_standard_logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AdTracking.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.APN_Augmented_LLD.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SearchLog.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_OCM_Staging.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Value_to_date.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.poc_segment_logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.CCO_Events.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Segment_logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Temp.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dev_sa_calc_engine_exchange.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AppNexus_Stg.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.CCPA_Analysis.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AppNexus_Qa.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.InstantDrawingEngine.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.TOM2DATA_PARQUET.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Reporting.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.TOM.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Soph.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AppNexus.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Augmented.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.auction_kv_labels_logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Surveys.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_TOM_Variables.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.manishv_test.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SearchAndWin.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dv_poc.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.CoReg.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.ManagingExits.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PrizeEngineFraud.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.GDFP_5499.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.OrderHeader.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SubscriberPreferences.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Session.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.DIServices_Temp.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Test_CCO_Events.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_SAS_ScoresCurrent.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Subscribers.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.scott_analysis.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SingleSchema.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VIP.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_SAS_Variables_Temp.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_SAS_Variables.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.data_governance.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_TOM_Staging.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.OnlineEcommerceScores.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PCHDEV_QUERY_Logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SearchActivity.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Persona_Event_Temp.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dev_topix_group.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_SAS_ScoreDeltaRepository.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.ComplianceManagement.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.ga_aggregations.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.tune_adhoc.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.mz_pchapp_custv_oct.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VariableEngine_OCM_Repository.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VIPDailyAggregate.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AppNexus_Ad_Revenue_SuperUser_Tier.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.IT_Tournament.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dev_operations_calc_engine.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.ShoppingCart.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.talend_uploadtest.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.GDFP_Line_Item.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.OrderDiscounts.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SEARCHPOCddddddd.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Standard_logs.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.SEARCHPOC.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dev_sa_calc_engine.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dev_im_calc_engine_exchange.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.gino.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.dev_im_calc_engine.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.IT_AppPromo.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.Campaign.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.race.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.AppsFlyer.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.VIPFIX.__TABLES__` where type=1 UNION ALL SELECT project_id,dataset_id,table_id, TIMESTAMP_MILLIS(creation_time) AS creation_time, TIMESTAMP_MILLIS(last_modified_time) AS last_modified_time,type objtype ,row_count, size_bytes FROM `alert-impulse-704.PrizeEngineWinnerCalls.__TABLES__` where type=1 ) GROUP BY 1,2,3,4,5,6 ORDER BY size_mb DESC